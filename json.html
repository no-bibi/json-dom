<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="./json.css">
    <script src="js/jq.js"></script>
    <script src="js/core.js"></script>
    <style>
       ul.list-all, li.list-one ,li.list-many,li.list-array{
            display: block;
            width: 100%;
            position: relative;
        }

        li.list-many:before {
            content: '';
            position: absolute;
            top: -7px;
            left: -17px;
            width: 0;
            height: 100%;
            border-left: 1px dotted #c0c4cc;
        }


        li.list-one:before {
            content: '';
            position: absolute;
            top: -8px;
            left: -17px;
            width: 0;
            height: 16px;
            border-left: 1px dotted #c0c4cc
        }

        li.list-one:after {
            content: '';
            position: absolute;
            top: 9px;
            left: -17px;
            width: 17px;
            height: 0;
            border-top: 1px dotted #c0c4cc;
        }


    </style>
</head>
<body>
<div class="main">
    <div class="json_html_content">
        <ul>
            <li data-node="data">
                <div class="single"><a class="close"></a>
                    <xmp class="key">json</xmp>
                </div>
            </li>
            <li>
                <ul class="list-all" id="out_content">

                </ul>
            </li>
        </ul>
    </div>
        <div class="search">
            <form>
                <input type="text" class="input" placeholder="Try everything">
            </form>
        </div>
</div>
<script>
    $(function () {
        build(
            {
                "assets": [
                    {
                        "appid": 570,
                        "contextid": "2",
                        "assetid": "13429164341",
                        "classid": "1334315906",
                        "instanceid": "57949762",
                        "amount": "1"
                    }
                ],
                "descriptions": [
                    {
                        "appid": 570,
                        "classid": "1334315906",
                        "instanceid": "57949762",
                        "currency": 0,
                        "background_color": "",
                        "icon_url": "-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KW1Zwwo4NUX4oFJZEHLbXX7gNTPcUmux5cX1nCQtui0fDHW1hLNgFSpKmaLh5l1P_JYi4MtY61ktSNka6iNeiBkDoHsZZ037_C99jz3lWx-xBrZj_wJ4CUcFVtNEaQpAb1YGEj9w",
                        "icon_url_large": "-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KW1Zwwo4NUX4oFJZEHLbXX7gNTPcUmux5cX1nCQtui0fDHW1hLNgFSpKmaLh5l1P_JYi594N2kk4XFkfbxYLiFw2lUsJNwiOqT8Yj20APi8hduMm6mLY_EI1Q8YV7YqVi8l_Cv28GPBoQfZg",
                        "descriptions": [
                            {
                                "type": "html",
                                "value": "这件珍藏中包含以下物品之一："
                            },
                            {
                                "type": "html",
                                "value": "疾风怒涛",
                                "color": "4b69ff"
                            },
                            {
                                "type": "html",
                                "value": "涌电星火之缚",
                                "color": "4b69ff"
                            },
                            {
                                "type": "html",
                                "value": "探星之欲",
                                "color": "4b69ff"
                            },
                            {
                                "type": "html",
                                "value": "邪原霸主",
                                "color": "4b69ff"
                            },
                            {
                                "type": "html",
                                "value": "魔气乌金",
                                "color": "4b69ff"
                            },
                            {
                                "type": "html",
                                "value": " "
                            },
                            {
                                "type": "html",
                                "value": "此外，你将有几率额外获得一件物品："
                            },
                            {
                                "type": "html",
                                "value": "锯木机",
                                "color": "4b69ff"
                            },
                            {
                                "type": "html",
                                "value": "无需任何符印即可解封此珍藏。珍藏内含完整的物品套装。"
                            }
                        ],
                        "tradable": 1,
                        "name": "先贤之镜的珍藏",
                        "name_color": "D2D2D2",
                        "type": "稀有 珍藏",
                        "market_name": "先贤之镜的珍藏",
                        "market_hash_name": "Treasure of the Seer's Eyeglass",
                        "commodity": 0,
                        "market_tradable_restriction": 7,
                        "market_marketable_restriction": 0,
                        "marketable": 1,
                        "tags": [
                            {
                                "category": "Quality",
                                "internal_name": "unique",
                                "localized_category_name": "品质",
                                "localized_tag_name": "Standard",
                                "color": "D2D2D2"
                            },
                            {
                                "category": "Rarity",
                                "internal_name": "Rarity_Rare",
                                "localized_category_name": "稀有度",
                                "localized_tag_name": "稀有",
                                "color": "4b69ff"
                            },
                            {
                                "category": "Type",
                                "internal_name": "treasure_chest",
                                "localized_category_name": "类型",
                                "localized_tag_name": "珍藏"
                            },
                            {
                                "category": "Slot",
                                "internal_name": "none",
                                "localized_category_name": "槽位",
                                "localized_tag_name": "无"
                            },
                            {
                                "category": "Hero",
                                "internal_name": "DOTA_OtherType",
                                "localized_category_name": "英雄",
                                "localized_tag_name": "其它"
                            }
                        ],
                        "m": 1
                    }
                ],
                "more_items": 1,
                "last_assetid": "13429164341",
                "total_inventory_count": 117,
                "success": 1,
                "rwgrsn": -2
            });

    })

    function build(json) {
        data = json;
        let html = json2Html(json)
        $('#out_content').html(html);
    }

    //开关
    $('.json_html_content').on('click', '.close,.open', function (event) {
        let node_status = $(this).hasClass('close') ? 'close' : 'open';
        let change_status = node_status === 'open' ? 'close' : 'open';
        let obj = $(this).removeClass('close').addClass(change_status).closest('li').next();
        obj.toggle();

    });

    //查找节点对应数据
    $('.json_html_content').on('click', 'xmp', function (event) {
        event.stopPropagation();
        let node = $(this).closest('li').attr('data-node');
        let str = JSON.stringify(eval(node));
        console.log(str);
    });

    //输入
    $('.search form').submit(function (event) {
        event.preventDefault();
        event.stopPropagation();
        let input = $('.input');
        let value = input.val();
        build(JSON.parse(value))
        input.val('');
    })


</script>
</body>
</html>
